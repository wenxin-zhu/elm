{"ast":null,"code":"import { ref, onMounted, computed } from 'vue';\nimport axios from 'axios';\nimport qs from 'qs';\nexport default {\n  name: 'Orders',\n  setup() {\n    const businessId = ref(null);\n    const business = ref({});\n    const user = ref(null);\n    const cartArr = ref([]);\n\n    //查询当前商家\n    const fetchBusinessInfo = () => {\n      axios.post('BusinessController/getBusinessById', qs.stringify({\n        businessId: businessId.value\n      })).then(response => {\n        business.value = response.data;\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n    //查询当前用户在购物车中的当前商家食品列表\n    const fetchFoodInfo = () => {\n      axios.post('CartController/listCart', qs.stringify({\n        userId: user.value.userId,\n        businessId: businessId.value\n      })).then(response => {\n        cartArr.value = response.data;\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n    const totalPrice = computed(() => {\n      let total = 0;\n      for (let item of cartArr.value) {\n        total += item.food.foodPrice * item.quantity;\n      }\n      total += business.deliveryPrice;\n      return total;\n    });\n    const formatSex = value => {\n      return value == 1 ? '先生' : '女士';\n    };\n    onMounted(() => {\n      user.value = JSON.parse(sessionStorage.getItem('user'));\n      if (!user.value) {\n        console.log('user.value is empty'); // 在控制台输出空值提示\n      }\n\n      fetchBusinessInfo();\n      fetchFoodInfo();\n    });\n    return {\n      businessId,\n      business,\n      user,\n      cartArr,\n      totalPrice,\n      fetchBusinessInfo,\n      fetchFoodInfo,\n      formatSex\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","axios","qs","name","setup","businessId","business","user","cartArr","fetchBusinessInfo","post","stringify","value","then","response","data","catch","error","console","fetchFoodInfo","userId","totalPrice","total","item","food","foodPrice","quantity","deliveryPrice","formatSex","JSON","parse","sessionStorage","getItem","log"],"sources":["F:\\myvue1\\elmclient\\elmclient\\src\\views\\Orders.vue"],"sourcesContent":["<template>\r\n\t<div class=\"wrapper\">\r\n\t\t<!--header部分-->\r\n\t\t<header>\r\n\t\t\t<p>确认订单</p>\r\n\t\t</header>\r\n\t\t\r\n\t\t<!--订单信息部分-->\r\n\t\t<div class = \"order-info\">\r\n\t\t\t<h5>订单配送至</h5>\r\n\t\t\t<div class = \"order-info-address\">\r\n\t\t\t\t<p>沈阳市浑南区智慧四街1-121号</p>\r\n\t\t\t\t<i class=\"fa fa-angle-right\"></i>\r\n\t\t\t</div>\r\n\t\t\t<p>{{user.userName}}{{formatSex(user.userSex)}} {{user.userId}}</p>\r\n\t\t</div>\r\n\t\t\r\n\t\t<h3>{{business.businessName}}</h3>\r\n\t\t\r\n\t\t<!--订单明细部分-->\r\n\t\t<ul class=\"order-detailed\">\r\n\t\t\t<li v-for=\"item in cartArr\">\r\n\t\t\t\t<div class=\"order-detailed-left\">\r\n\t\t\t\t\t<img :src=\"item.food.foodImg\">\r\n\t\t\t\t\t<p>{{item.food.foodName}} x {{item.quantity}}</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<p>&#165;{{item.food.foodPrice*item.quantity}}</p>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t\t<div class=\"order-deliveryfee\">\r\n\t\t\t<p>配送费</p>\r\n\t\t\t<p>&#165;{{business.deliveryPrice}}</p>\r\n\t\t</div>\r\n\t\t\r\n\t\t<!--合计部分-->\r\n\t\t<div class=\"total\">\r\n\t\t    <div class=\"total-left\">\r\n\t\t        &#165;{{totalPrice}}\r\n\t\t    </div>\r\n\t\t    <div class=\"total-right\" onclick=\"location.href='payment.html'\">\r\n\t\t        去支付\r\n\t\t    </div>\r\n\t\t</div>\r\n\t</div>\n</template>\n\n<script>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted,\r\n\t\tcomputed\r\n\t} from 'vue';\r\n\timport axios from 'axios';\r\n\timport qs from 'qs';\r\n\t\r\n\texport default{\r\n\t\tname: 'Orders',\r\n\t\tsetup(){\r\n\t\t\tconst businessId = ref(null);\r\n\t\t\tconst business = ref({});\r\n\t\t\tconst user = ref(null);\r\n\t\t\tconst cartArr = ref([]);\r\n\t\t\t\r\n\t\t\t//查询当前商家\r\n\t\t\tconst fetchBusinessInfo = () => {\r\n\t\t\t\taxios\r\n\t\t\t\t\t.post('BusinessController/getBusinessById', qs.stringify({\r\n\t\t\t\t\t\tbusinessId: businessId.value\r\n\t\t\t\t\t}))\r\n\t\t\t\t\t.then(response => {\r\n\t\t\t\t\t\tbusiness.value = response.data;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\t\t\t//查询当前用户在购物车中的当前商家食品列表\r\n\t\t\tconst fetchFoodInfo = () => {\r\n\t\t\t\taxios\r\n\t\t\t\t\t.post('CartController/listCart', qs.stringify({\r\n\t\t\t\t\t\tuserId: user.value.userId,\r\n\t\t\t\t\t\tbusinessId: businessId.value\r\n\t\t\t\t\t}))\r\n\t\t\t\t\t.then(response => {\r\n\t\t\t\t\t\tcartArr.value = response.data;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tconst totalPrice = computed(() => {\r\n\t\t\t    let total = 0;\r\n\t\t\t    for (let item of cartArr.value) {\r\n\t\t\t        total += item.food.foodPrice * item.quantity;\r\n\t\t\t    }\r\n\t\t\t\ttotal += business.deliveryPrice;\r\n\t\t\t    return total;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tconst formatSex = (value) => {\r\n\t\t\t    return value == 1 ? '先生' : '女士';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tonMounted(() => {\r\n\t\t\t    user.value = JSON.parse(sessionStorage.getItem('user'));\r\n\t\t\t\t if (!user.value) {\r\n\t\t\t\t        console.log('user.value is empty'); // 在控制台输出空值提示\r\n\t\t\t\t      }\r\n\t\t\t\tfetchBusinessInfo(); \r\n\t\t\t\tfetchFoodInfo(); \r\n\t\t\t});\r\n\t\t\t\r\n\t\t\treturn{\r\n\t\t\t\tbusinessId,\r\n\t\t\t\tbusiness,\r\n\t\t\t\tuser,\r\n\t\t\t\tcartArr,\r\n\t\t\t\ttotalPrice,\r\n\t\t\t\tfetchBusinessInfo,\r\n\t\t\t\tfetchFoodInfo,\r\n\t\t\t\tformatSex\r\n\t\t\t}\r\n\t\t}\r\n\t}\n</script>\n\n<style scoped>\r\n\t/****************** 总容器 ******************/\r\n\t.wrapper{\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t/****************** header部分 ******************/\r\n\t.wrapper header{\r\n\t\twidth: 100%;\r\n\t\theight: 12vw;\r\n\t\tbackground-color: #0097FF;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.8vw;\r\n\t\t\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tz-index: 1000;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\t/****************** 订单信息部分 ******************/\r\n\t.wrapper .order-info{\r\n\t\tcolor: white;\r\n\t\twidth: 100%;\r\n\t\tmargin-top: 12vw;\r\n\t\tbackground-color: #0097FF;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 2vw;\r\n\t}\r\n\t\r\n\t.wrapper .order-info .h5{\r\n\t\tfont-size: 3vw;\r\n\t\tfont-weight: 300;\r\n\t}\r\n\t\r\n\t.wrapper .order-info .order-info-address{\r\n\t\twidth: 100%;\r\n\t\tfont-weight: 700;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tuser-select: none;\r\n\t\tcursor: pointer;\r\n\t\tmargin: 1vw 0; /*中间一行的上下 左右间距*/\r\n\t}\r\n\t\r\n\t.wrapper .order-info .order-info-address p{\r\n\t\twidth: 90%; /*避免地址过长时换行太靠后*/\r\n\t\tfont-size: 5vw;\r\n\t}\r\n\t\r\n\t.wrapper .order-info .order-info-address i{\r\n\t\tfont-size: 6vw;\r\n\t}\r\n\t\r\n\t.wrapper .order-info p{\r\n\t\tfont-size: 3vw;\r\n\t}\r\n\t\r\n\t.wrapper h3{\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 3vw;\r\n\t\tfont-size: 4vw;\r\n\t\tcolor: #666;\r\n\t\tborder-bottom: solid 1px #DDD;\r\n\t}\r\n\t\r\n\t/****************** 订单明细部分 ******************/\r\n\t.wrapper .order-detailed{\r\n\t\twidth: 100%;\r\n\t}\r\n\t\r\n\t.wrapper .order-detailed li{\r\n\t\twidth: 100%;\r\n\t\theight: 16vw;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 3vw;\r\n\t\tcolor: #666;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.wrapper .order-detailed li .order-detailed-left{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.wrapper .order-detailed li .order-detailed-left img{\r\n\t\twidth: 10vw;\r\n\t\theight: 10vw;\r\n\t}\r\n\t\r\n\t.wrapper .order-detailed li .order-detailed-left p{\r\n\t    font-size: 3.5vw;\r\n\t    margin-left: 3vw;\r\n\t}\r\n\t\r\n\t.wrapper .order-detailed li p{\r\n\t    font-size: 3.5vw;\r\n\t}\r\n\t\r\n\t.wrapper .order-deliveryfee{\r\n\t\twidth: 100%;\r\n\t\theight: 16vw;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 3vw;\r\n\t\tcolor: #666;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tfont-size: 3.5vw;\r\n\t}\r\n\t\r\n\t/****************** 订单合计部分 ******************/\r\n\t.wrapper .total{\r\n\t\twidth: 100%;\r\n\t\theight: 14vw;\r\n\t\t\r\n\t\tposition: fixed;/*固定到底部*/\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\t\r\n\t}\r\n\t\r\n\t.wrapper .total .total-left{\r\n\t\tflex: 2;\r\n\t\tbackground-color: #505051;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.5vw;\r\n\t\tfont-weight: 700;\r\n\t\tuser-select: none;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.wrapper .total .total-right{\r\n\t\tflex: 1;\r\n\t\tbackground-color: #38CA73;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.5vw;\r\n\t\tfont-weight: 700;\r\n\t\tuser-select: none;\r\n\t\tcursor: pointer;\r\n\t\t\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\n</style>"],"mappings":"AA+CC,SACCA,GAAG,EACHC,SAAS,EACTC,QAAO,QACD,KAAK;AACZ,OAAOC,KAAI,MAAO,OAAO;AACzB,OAAOC,EAAC,MAAO,IAAI;AAEnB,eAAc;EACbC,IAAI,EAAE,QAAQ;EACdC,KAAKA,CAAA,EAAE;IACN,MAAMC,UAAS,GAAIP,GAAG,CAAC,IAAI,CAAC;IAC5B,MAAMQ,QAAO,GAAIR,GAAG,CAAC,CAAC,CAAC,CAAC;IACxB,MAAMS,IAAG,GAAIT,GAAG,CAAC,IAAI,CAAC;IACtB,MAAMU,OAAM,GAAIV,GAAG,CAAC,EAAE,CAAC;;IAEvB;IACA,MAAMW,iBAAgB,GAAIA,CAAA,KAAM;MAC/BR,KAAI,CACFS,IAAI,CAAC,oCAAoC,EAAER,EAAE,CAACS,SAAS,CAAC;QACxDN,UAAU,EAAEA,UAAU,CAACO;MACxB,CAAC,CAAC,EACDC,IAAI,CAACC,QAAO,IAAK;QACjBR,QAAQ,CAACM,KAAI,GAAIE,QAAQ,CAACC,IAAI;MAC/B,CAAC,EACAC,KAAK,CAACC,KAAI,IAAK;QACfC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;IACJ,CAAC;IACD;IACA,MAAME,aAAY,GAAIA,CAAA,KAAM;MAC3BlB,KAAI,CACFS,IAAI,CAAC,yBAAyB,EAAER,EAAE,CAACS,SAAS,CAAC;QAC7CS,MAAM,EAAEb,IAAI,CAACK,KAAK,CAACQ,MAAM;QACzBf,UAAU,EAAEA,UAAU,CAACO;MACxB,CAAC,CAAC,EACDC,IAAI,CAACC,QAAO,IAAK;QACjBN,OAAO,CAACI,KAAI,GAAIE,QAAQ,CAACC,IAAI;MAC9B,CAAC,EACAC,KAAK,CAACC,KAAI,IAAK;QACfC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;IACJ,CAAC;IAED,MAAMI,UAAS,GAAIrB,QAAQ,CAAC,MAAM;MAC9B,IAAIsB,KAAI,GAAI,CAAC;MACb,KAAK,IAAIC,IAAG,IAAKf,OAAO,CAACI,KAAK,EAAE;QAC5BU,KAAI,IAAKC,IAAI,CAACC,IAAI,CAACC,SAAQ,GAAIF,IAAI,CAACG,QAAQ;MAChD;MACHJ,KAAI,IAAKhB,QAAQ,CAACqB,aAAa;MAC5B,OAAOL,KAAK;IAChB,CAAC,CAAC;IAEF,MAAMM,SAAQ,GAAKhB,KAAK,IAAK;MACzB,OAAOA,KAAI,IAAK,IAAI,IAAG,GAAI,IAAI;IACnC;IAEAb,SAAS,CAAC,MAAM;MACZQ,IAAI,CAACK,KAAI,GAAIiB,IAAI,CAACC,KAAK,CAACC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC;MACzD,IAAI,CAACzB,IAAI,CAACK,KAAK,EAAE;QACVM,OAAO,CAACe,GAAG,CAAC,qBAAqB,CAAC,EAAE;MACtC;;MACNxB,iBAAiB,CAAC,CAAC;MACnBU,aAAa,CAAC,CAAC;IAChB,CAAC,CAAC;IAEF,OAAM;MACLd,UAAU;MACVC,QAAQ;MACRC,IAAI;MACJC,OAAO;MACPa,UAAU;MACVZ,iBAAiB;MACjBU,aAAa;MACbS;IACD;EACD;AACD"},"metadata":{},"sourceType":"module","externalDependencies":[]}